@import url('https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Estilos base para todos os dispositivos */
:root {
  --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  --mobile-browser-chrome-height: env(safe-area-inset-top, 0px);
  --mobile-browser-bottom-nav: env(safe-area-inset-bottom, 0px);
  touch-action: manipulation; /* Previne delays de toque em dispositivos móveis */
}

/* Viewport height dinâmico - corrige problemas de altura em navegadores móveis */
:root {
  --vh: 1vh;
}

/* Melhor controle de altura para dispositivos móveis */
@media (max-width: 767px) {
  html {
    height: -webkit-fill-available;
  }
  body {
    min-height: 100vh;
    min-height: -webkit-fill-available;
    min-height: calc(var(--vh, 1vh) * 100);
  }
}

html, body {
  height: 100%;
  width: 100%;
  margin: 0;
  padding: 0;
  overscroll-behavior: none;
}

/* Layout adaptativo baseado no tipo de dispositivo */
@media (min-width: 768px) {
  /* Desktop: layout fixo com overflow escondido */
  html, body {
    overflow: hidden;
    position: fixed;
  }
}

@media (max-width: 767px) {
  /* Mobile: permite view adaptativo */
  html, body {
    overflow: hidden;
    position: fixed;
    /* Ajustes para browser chrome */
    height: calc(100% - var(--mobile-browser-chrome-height));
    padding-top: var(--mobile-browser-chrome-height);
    padding-bottom: var(--mobile-browser-bottom-nav);
  }
}

/* Viewport height adaptativo para iOS */
.fixed-layout {
  height: 100% !important;
  height: 100vh !important; 
  height: calc(var(--vh, 1vh) * 100) !important;
  overflow: hidden;
}

#root {
  height: 100%;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* Esconder a scrollbar enquanto mantém a funcionalidade */
.scrollbar-none::-webkit-scrollbar {
  display: none;
}

.scrollbar-none {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* Classe para elementos com rolagem interna */
.content-scrollable {
  overflow-y: auto;
  overflow-x: hidden;
  scrollbar-width: thin;
  -webkit-overflow-scrolling: touch; /* Scroll suave em iOS */
  overscroll-behavior: contain; /* Previne scroll cascading */
  padding-bottom: calc(env(safe-area-inset-bottom) + 1rem); /* Espaço extra para evitar conteúdo oculto */
}

/* Adiciona classe para texto muito pequeno */
@layer utilities {
  .text-tiny {
    font-size: 0.7rem;
    line-height: 1rem;
  }
  
  /* Utilitários para ajustar em dispositivos com notch ou barra de navegação */
  .pt-safe {
    padding-top: env(safe-area-inset-top, 0px);
  }
  
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom, 0px);
  }
  
  .pl-safe {
    padding-left: env(safe-area-inset-left, 0px);
  }
  
  .pr-safe {
    padding-right: env(safe-area-inset-right, 0px);
  }
}

* {
  font-family: var(--font-family) !important;
  -webkit-tap-highlight-color: transparent; /* Remove highlight ao tocar em elementos */
}

body {
  font-weight: 100;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  overscroll-behavior: none; /* Previne efeitos de scroll bounce que causam jank */
}

h1, h2, h3, h4, h5, h6 {
  font-weight: 100 !important;
  letter-spacing: -0.025em;
}

input, select, textarea, button {
  font-family: var(--font-family) !important;
  font-weight: 100;
}

::placeholder {
  font-weight: 100;
  opacity: 0.7;
}

@layer base {
  :root {
    --font-rustic: 'Rubik Dirt', system-ui;
    --font-pirate: 'Pirata One', cursive;
  }

  body {
    @apply antialiased;
  }

  h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-rustic);
    font-weight: normal;
  }

  .font-rustic {
    font-family: var(--font-rustic);
    font-weight: normal;
  }

  .font-pirate {
    font-family: var(--font-pirate);
    font-weight: normal;
  }
  
  /* Melhoria para inputs - prevenindo zoom em iOS */
  @media screen and (max-width: 767px) {
    input, select, textarea {
      font-size: 16px !important; /* Previne zoom automático em inputs no iOS */
    }
  }
}

@layer components {
  /* Versão otimizada do glass-morphism para mobile */
  .glass-morphism {
    @apply bg-white/[0.07] dark:bg-black/[0.15] border border-white/[0.15] dark:border-white/[0.1];
  }
  
  /* Versão completa do glass-morphism apenas para desktop */
  @media (min-width: 768px) {
    .glass-morphism-desktop {
      backdrop-filter: blur(16px);
    }
  }

  .input-field {
    @apply bg-transparent border-0 border-b-2 border-white/30 dark:border-white/20 px-0 py-2 focus:ring-0 focus:border-white/50 font-arial text-lg;
  }

  .input-field[type="date"] {
    @apply text-white;
  }

  .input-field[type="date"]::-webkit-calendar-picker-indicator {
    @apply filter invert opacity-50 hover:opacity-75 transition-opacity cursor-pointer;
  }
  
  /* Simplificação das animações em dispositivos móveis */
  .hover-lift {
    @apply transition-transform duration-200;
  }
  
  @media (min-width: 768px) {
    .hover-lift:hover {
      @apply transform -translate-y-1;
    }
  }
  
  .stagger-fade {
    @apply opacity-0 transition-opacity duration-700;
  }
}

/* Layout para páginas com altura fixa e rolagem apenas no conteúdo */
.page-container {
  display: flex;
  flex-direction: column;
  height: 100%;
  position: relative;
  overflow: hidden;
  /* Safe area insets para notches e barras de navegação */
  padding-top: env(safe-area-inset-top, 0px);
  padding-bottom: env(safe-area-inset-bottom, 0px);
  padding-left: env(safe-area-inset-left, 0px);
  padding-right: env(safe-area-inset-right, 0px);
}

.page-header {
  flex-shrink: 0;
  position: relative;
  z-index: 10;
}

.page-content {
  flex: 1;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  position: relative;
  z-index: 5;
}

.page-footer {
  flex-shrink: 0;
  position: relative;
  z-index: 10;
  margin-bottom: env(safe-area-inset-bottom, 0px); /* Respeita a área segura inferior */
}

/* Script para atualizar --vh quando a altura da viewport muda */
@media (max-width: 767px) {
  body::before {
    content: "";
    display: block;
    position: fixed;
    width: 100%;
    height: 0;
    /* Este script será executado inline no head */
    background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" height="0" width="0" onload="(function(){function setVH(){var vh=window.innerHeight*0.01;document.documentElement.style.setProperty(%27--vh%27,vh+%27px%27)}setVH();window.addEventListener(%27resize%27,setVH)})()"%3E%3C/svg%3E');
  }
}

/* Otimizado para mobile - desativa ou reduz a intensidade do efeito grain em dispositivos móveis */
.grain {
  position: fixed;
  top: -150%;
  left: -50%;
  right: -50%;
  bottom: -150%;
  width: 200%;
  height: 300vh;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
  opacity: 0.07; /* Reduzido para melhor performance */
  pointer-events: none;
  will-change: transform; /* Otimização para composição em GPU */
  transform: translateZ(0); /* Força o uso de aceleração de hardware */
}

/* Desativa efeito grain completamente em telas muito pequenas */
@media (max-width: 480px) {
  .grain {
    display: none;
  }
}

.dark .grain {
  opacity: 0.1; /* Reduzido para melhor performance */
}

.font-arial {
  font-family: Arial, sans-serif;
}

/* Fix para teclado virtual em dispositivos iOS */
@supports (-webkit-touch-callout: none) {
  .page-container {
    height: -webkit-fill-available;
  }
  
  .ios-keyboard-open {
    height: auto !important;
    position: absolute !important;
  }
}

/* Otimizações para performance mobile */
@media (max-width: 768px) {
  /* Força uma animação mais suave em celulares */
  * {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    backface-visibility: hidden;
    perspective: 1000;
  }
  
  /* Desabilita animações complexas em dispositivos móveis */
  .animate-spin {
    animation-duration: 1.5s; /* Animação mais lenta consome menos recursos */
  }
  
  /* Reduz a complexidade de sombras */
  .shadow-md, .shadow-lg, .shadow-xl {
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  
  /* Ajustes para navegação de tela cheia em browsers mobile */
  .fullscreen-mobile {
    height: 100vh;
    height: calc(var(--vh, 1vh) * 100);
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    z-index: 9999;
  }
}

/* Otimizações para dispositivos de baixo desempenho - aplicadas via usePerformanceOptimizer */
.low-end-device {
  /* Otimizações gerais para dispositivos de baixo desempenho */
  --shadow-strength: 0.25; /* Reduz intensidade de sombras */
}

/* Reduz ou desabilita animações para melhorar performance */
.reduce-animation {
  --transition-slow: 0s !important; /* Desabilita transições lentas */
  --transition-medium: 0s !important; /* Desabilita transições médias */
  --transition-fast: 0.1s !important; /* Mantém transições rápidas mas mais curtas */
  
  /* Remove todas as animações não-essenciais */
  * {
    animation-duration: 0s !important;
    animation-delay: 0s !important;
    transition-duration: 0s !important;
    transition-delay: 0s !important;
  }
  
  /* Permite apenas animações específicas essenciais para UX */
  .animate-spin {
    animation-duration: 1.5s !important;
  }
  
  /* Remove efeitos de blur que são pesados para renderizar */
  .backdrop-blur-sm, 
  .backdrop-blur, 
  .backdrop-blur-md, 
  .backdrop-blur-lg, 
  .backdrop-blur-xl {
    backdrop-filter: none !important;
  }
}